---
install_packages:
  - 'nginx'
  - 'libnginx-mod-http-perl'
  - 'liburi-encode-perl'
create_files:
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    state:              'directory'
    dest:               '/usr/local/share/remote'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    state:              'directory'
    dest:               '/usr/local/share/remote/www'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    state:              'directory'
    dest:               '/usr/local/share/remote/parts'
  - owner:              'root'
    group:              'root'
    mode:               '0755'
    state:              'directory'
    dest:               '/usr/local/share/remote/www/cgi-bin'
install_files:
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "files/www/style.css"
    dest:               '/usr/local/share/remote/www/html/style.css'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "files/www/index.html"
    dest:               '/usr/local/share/remote/www/html/index.html'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "files/www/select-user.html"
    dest:               '/usr/local/share/remote/www/html/select-user.html'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "files/conf/sudoers.pianobar_restart"
    dest:               '/etc/sudoers.d/pianobar_restart'
  - owner:              'root'
    group:              'root'
    mode:               '0644'
    src:                "files/conf/sudoers.remote_reboot"
    dest:               '/etc/sudoers.d/remote_reboot'
sync_dirs:
  - src:                "files/parts/"
    dest:               '/usr/local/share/remote/parts/'
    delete:             'yes'
  - src:                "files/cgi-bin/"
    dest:               '/usr/local/share/remote/cgi-bin/'
    delete:             'no'
restart_services:
  - 'nginx'
known_hosts:            "{{ groups['storage_server'] }}"
